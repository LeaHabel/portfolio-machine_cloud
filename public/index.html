<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Web site created using create-react-app" />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js">
  </script>
  <title>React App</title>

  <!-- Javascript - Simple Serial -->
  <script lang="text/javascript" src="js/simple-serial.min.js"></script>
</head>

<body>
  <!-- React is inside root element -->
  <div id="root"></div>

  <button id="permissionElement">Connect Serial Port</button>

  <!-- Javascript â€“ Simple Serial Functions -->
  <script type="text/javascript">
    /* variables */
    let toggle = false;
    var baud = 57600;

    /* CHANGE IDS HERE */
    var cdID = 1; // Communication Design ID
    var mdID = 2; // Media Design ID
    var sdID = 3; // Sound Design ID
    var idID = 4; // Interaction Design ID
    var sensorRelease = 5; // Additional Value when you release the sensor



    /* connect button IN */
    const connection = SimpleSerial.connect({
      baudRate: baud, // baud settings for the serial connection
      requestButton: "permissionElement", // link to the id of the button that needs to be clicked
      requestAccessOnPageLoad: false, // if true - it will change to a modal instead of a normal button with the some functionality
      //logOutgoingSerialData: true, // log outgoing data in console
      //logIncomingSerialData: true, // log incoming data in console
    })

    async function connect() {
      port = await navigator.serial.requestPort();
    }


    /* listening to events from the arduino */
    connection.on("value", function (data) {
      console.log(data);
      console.log("testestste");

      //output of received data
      //console.log('Received value from arduino is: ' + data)
      if (data == cdID) {
        console.log("Communication Design");
        localStorage.setItem('data', 1);
      }
      else if (data == mdID) {
        console.log("Media Design");
        localStorage.setItem('data', 2);
      }
      else if (data == sdID) {
        console.log("Sound Design");
        localStorage.setItem('data', 3);
      }
      else if (data == idID) {
        console.log("Interaction Design");
        localStorage.setItem('data', 4);
      }




    });



    /* sending data to the arduino */
    async function toggleLights() {
      if (toggle == false) {
        await connection.send("event", 1);
        toggle = true;

        console.log("Lights ON");
      }
      else {
        await connection.send("event", 0);
        toggle = false;

        console.log("Lights OFF");
      }
    }




  </script>


</body>

</html>